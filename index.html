<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EXIT</title>

<style>
* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family:"Hiragino Mincho ProN","MS Mincho",serif;
  background:#000;
  color:#ccc;
  min-height:100vh;
  padding:20px;
  overflow-x:hidden;
}

/* 背景ノイズ */
body::before {
  content:"";
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    to bottom,
    rgba(0,255,255,.05) 0,
    rgba(0,255,255,.05) 1px,
    transparent 2px
  );
  opacity:.08;
  pointer-events:none;
  z-index:0;
}

/* コードレイン */
.code-rain {
  position:fixed;
  inset:0;
  z-index:1;
  pointer-events:none;
  font-family:"Courier New", monospace;
  font-size:.85rem;
  opacity:.06;
  white-space:pre;
  color:#0ff;
  animation:scrollCode 14s linear infinite;
}
@keyframes scrollCode {
  from { transform:translateY(0); }
  to { transform:translateY(-100%); }
}

.header {
  text-align:center;
  margin-bottom:30px;
  position:relative;
  z-index:5;
}
.title {
  font-size:1.6rem;
  letter-spacing:.12em;
}
.subtitle {
  font-size:.9rem;
  color:#8fa1a1;
  margin-top:8px;
}

/* 画像一覧 */
.image-container {
  columns:5;
  column-gap:15px;
  position:relative;
  z-index:5;
}
.image-item {
  break-inside:avoid;
  margin-bottom:15px;
  border:1px solid #223;
  background:#111;
  cursor:pointer;
  transition:.2s;
}
.image-item:hover { border-color:#0aa; }
.image-item.selected {
  border:2px solid #ff0044;
}

.image-placeholder {
  width:100%;
  aspect-ratio:var(--aspect-ratio);
  overflow:hidden;
}
.image-placeholder img {
  width:100%;
  height:100%;
  object-fit:cover;
}

/* 送信 */
.submit-container {
  text-align:center;
  margin-top:25px;
  position:relative;
  z-index:5;
}
.submit-btn {
  padding:12px 40px;
  letter-spacing:.15em;
  background:#022;
  border:1px solid #0aa;
  color:#cde;
  opacity:.4;
  pointer-events:none;
}
.submit-btn.active {
  opacity:1;
  pointer-events:auto;
}

/* モーダル */
.overlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  z-index:900;
}
.modal {
  position:fixed;
  top:50%; left:50%;
  transform:translate(-50%,-50%);
  background:#111;
  border:1px solid #044;
  padding:20px;
  max-width:90vw;
  z-index:901;
}
.modal img {
  max-width: 92vw;
  max-height: 88vh;
  width: auto;
  height: auto;
}
.caption {
  margin-top:10px;
  font-size:.85rem;
}
.modal button {
  margin-top:12px;
  padding:8px 30px;
  background:#022;
  border:1px solid #0aa;
  color:#cde;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="code-rain" id="codeRain"></div>

<div class="header">
  <h1 class="title">Liminal Space脱出口生成フォーム</h1>
  <p class="subtitle">線遠近法が使われている作品を選択してください</p>
</div>

<div class="image-container" id="imageContainer"></div>

<div class="submit-container">
  <button class="submit-btn" id="submitBtn">送信</button>
</div>

<!-- 拡大表示 -->
<div class="overlay" id="viewer">
  <div class="modal">
    <img id="viewerImg">
    <div class="caption" id="viewerCap"></div>
    <button onclick="closeViewer()">閉じる</button>
  </div>
</div>

<script>
/* コードレイン生成 */
const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
let text="";
for(let y=0;y<35;y++){
  let line="";
  for(let x=0;x<80;x++){
    line+=chars[Math.floor(Math.random()*chars.length)];
  }
  text+=line+"\n";
}
document.getElementById("codeRain").textContent=text;

/* ==== 画像＋キャプション定義 ==== */
const images = [
  { type:'other', url:'gazou/1.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/2.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/3.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/4.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/5.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/6.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/7.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/8.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/9.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/10.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/11.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/12.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/13.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/14.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/15.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/16.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/17.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/18.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/19.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/20.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/21.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/22.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/23.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/24.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/25.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/26.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/27.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/28.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/29.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/30.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/31.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/32.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/33.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/34.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/35.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/36.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/37.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/38.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/39.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/40.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/41.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/42.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/43.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/44.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/45.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/46.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/47.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/48.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/49.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/50.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/51.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/52.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/53.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/54.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/55.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/56.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/57.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/58.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/59.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/60.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/61.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/62.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/63.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/64.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/65.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/66.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/67.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/68.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'other', url:'gazou/69.jpg',  caption:'この階段は、上にも下にも続いていない。' },
  { type:'other', url:'gazou/70.jpg',  caption:'誰もいないはずの廊下に、足音だけが残っている。' },
  { type:'other', url:'gazou/71.jpg',  caption:'使われなくなった案内板が、まだ誰かを待っている。' },
  { type:'door',  url:'gazou/door.jpg', caption:'出口として観測された唯一の構造。' }
];

/* シャッフル（captionは保持） */
images.sort(()=>Math.random()-.5);

const container=document.getElementById("imageContainer");
let selected=null;

images.forEach(img=>{
  const item=document.createElement("div");
  item.className="image-item";
  item.dataset.type=img.type;

  const ph=document.createElement("div");
  ph.className="image-placeholder";
  ph.style.setProperty("--aspect-ratio",0.8);

  const im=document.createElement("img");
  im.src=img.url;
  ph.appendChild(im);

  item.appendChild(ph);

  item.onclick=()=>{
    if(selected) selected.classList.remove("selected");
    selected=item;
    item.classList.add("selected");
    document.getElementById("submitBtn").classList.add("active");
    openViewer(img);
  };

  container.appendChild(item);
});

/* 拡大表示 */
function openViewer(img){
  document.getElementById("viewerImg").src=img.url;
  document.getElementById("viewerCap").textContent=img.caption;
  document.getElementById("viewer").style.display="block";
}
function closeViewer(){
  document.getElementById("viewer").style.display="none";
}

/* 送信 */
document.getElementById("submitBtn").onclick=()=>{
  if(!selected) return;
  if(selected.dataset.type==="door"){
    location.href="https://hazamashobo.github.io/fin/";
  } else {
    alert("出口ではありません");
  }
};
</script>

</body>
</html>
